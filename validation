import pandas as pd

# Chargement du dataset
df = pd.read_csv('02_real_world_dataset (1).csv')

# Groupement par Editeur et Label (0 ou 1) et comptage
publisher_analysis = df.groupby(['Publisher', 'Est_Predateur']).size().unstack(fill_value=0)

# Renommer les colonnes pour plus de clarté
publisher_analysis.columns = ['Revues Fiables (0)', 'Revues Prédatrices (1)']

# Calcul du total et du taux de prédation
publisher_analysis['Total'] = publisher_analysis['Revues Fiables (0)'] + publisher_analysis['Revues Prédatrices (1)']
publisher_analysis['Taux Arnaque (%)'] = (publisher_analysis['Revues Prédatrices (1)'] / publisher_analysis['Total']) * 100

# Tri pour afficher les plus gros "Arnaque Publishers" en premier (ceux avec le plus de revues label 1)
top_predatory_publishers = publisher_analysis.sort_values(by='Revues Prédatrices (1)', ascending=False).head(10)

print(top_predatory_publishers)